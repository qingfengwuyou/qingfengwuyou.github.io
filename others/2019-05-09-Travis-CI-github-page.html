<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Travis CI 部署博客到 github page | 清风无忧前端开发博客</title>
    <meta name="description" content="清风无忧前端开发博客">
    
    
    <link rel="preload" href="/assets/css/0.styles.713e63e4.css" as="style"><link rel="preload" href="/assets/js/app.835acc23.js" as="script"><link rel="preload" href="/assets/js/2.a5ff60db.js" as="script"><link rel="preload" href="/assets/js/28.446392b8.js" as="script"><link rel="prefetch" href="/assets/js/10.b29ebb99.js"><link rel="prefetch" href="/assets/js/11.a9f97739.js"><link rel="prefetch" href="/assets/js/12.466c0ea1.js"><link rel="prefetch" href="/assets/js/13.fdbb5893.js"><link rel="prefetch" href="/assets/js/14.1a2eafcc.js"><link rel="prefetch" href="/assets/js/15.7789cf3b.js"><link rel="prefetch" href="/assets/js/16.600f808c.js"><link rel="prefetch" href="/assets/js/17.b8871b2c.js"><link rel="prefetch" href="/assets/js/18.2b373a6a.js"><link rel="prefetch" href="/assets/js/19.4038c301.js"><link rel="prefetch" href="/assets/js/20.c508f5ed.js"><link rel="prefetch" href="/assets/js/21.442fda17.js"><link rel="prefetch" href="/assets/js/22.d07bb81c.js"><link rel="prefetch" href="/assets/js/23.3fd3857d.js"><link rel="prefetch" href="/assets/js/24.636b0d95.js"><link rel="prefetch" href="/assets/js/25.f949e755.js"><link rel="prefetch" href="/assets/js/26.c5640787.js"><link rel="prefetch" href="/assets/js/27.1e49a206.js"><link rel="prefetch" href="/assets/js/29.5805a437.js"><link rel="prefetch" href="/assets/js/3.85313af3.js"><link rel="prefetch" href="/assets/js/30.14fd74e2.js"><link rel="prefetch" href="/assets/js/31.58a90080.js"><link rel="prefetch" href="/assets/js/32.0f58450f.js"><link rel="prefetch" href="/assets/js/33.6fe6cd2f.js"><link rel="prefetch" href="/assets/js/34.a985f65b.js"><link rel="prefetch" href="/assets/js/35.f7edbaf2.js"><link rel="prefetch" href="/assets/js/4.e164a41b.js"><link rel="prefetch" href="/assets/js/5.9455a35e.js"><link rel="prefetch" href="/assets/js/6.60120b75.js"><link rel="prefetch" href="/assets/js/7.023135da.js"><link rel="prefetch" href="/assets/js/8.39eab0d9.js"><link rel="prefetch" href="/assets/js/9.7e9ea13a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.713e63e4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">清风无忧前端开发博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/css/basic/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/css/skill/" class="nav-link">技巧</a></li><li class="dropdown-item"><!----> <a href="/css/ref/" class="nav-link">参考</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/type-script/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/javascript/skill/" class="nav-link">技巧</a></li><li class="dropdown-item"><!----> <a href="/javascript/ref/" class="nav-link">参考</a></li></ul></div></div><div class="nav-item"><a href="/lib/" class="nav-link">库与框架</a></div><div class="nav-item"><a href="/database/" class="nav-link">数据库</a></div><div class="nav-item"><a href="/back-end/" class="nav-link">后端</a></div><div class="nav-item"><a href="/others/" class="nav-link router-link-active">杂项</a></div><div class="nav-item"><a href="/resource/" class="nav-link">资源</a></div><div class="nav-item"><a href="/philosophy/" class="nav-link">哲学</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/css/basic/" class="nav-link">基础</a></li><li class="dropdown-item"><!----> <a href="/css/skill/" class="nav-link">技巧</a></li><li class="dropdown-item"><!----> <a href="/css/ref/" class="nav-link">参考</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/type-script/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/javascript/skill/" class="nav-link">技巧</a></li><li class="dropdown-item"><!----> <a href="/javascript/ref/" class="nav-link">参考</a></li></ul></div></div><div class="nav-item"><a href="/lib/" class="nav-link">库与框架</a></div><div class="nav-item"><a href="/database/" class="nav-link">数据库</a></div><div class="nav-item"><a href="/back-end/" class="nav-link">后端</a></div><div class="nav-item"><a href="/others/" class="nav-link router-link-active">杂项</a></div><div class="nav-item"><a href="/resource/" class="nav-link">资源</a></div><div class="nav-item"><a href="/philosophy/" class="nav-link">哲学</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>杂项</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/others/2019-05-09-Travis-CI-github-page.html" class="active sidebar-link">Travis CI 部署博客到 github page</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/others/2019-05-09-Travis-CI-github-page.html#说明" class="sidebar-link">说明</a></li><li class="sidebar-sub-header"><a href="/others/2019-05-09-Travis-CI-github-page.html#特殊要求" class="sidebar-link">特殊要求</a></li><li class="sidebar-sub-header"><a href="/others/2019-05-09-Travis-CI-github-page.html#踩过的坑" class="sidebar-link">踩过的坑</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="travis-ci-部署博客到-github-page"><a href="#travis-ci-部署博客到-github-page" aria-hidden="true" class="header-anchor">#</a> Travis CI 部署博客到 github page</h1> <h2 id="说明"><a href="#说明" aria-hidden="true" class="header-anchor">#</a> 说明</h2> <p>本博客是用 <a href="https://v1.vuepress.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">VuePress 1.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 构建.</p> <p>利用 Travis CI 自动部署时, 踩了一些坑, 先简单记录一下</p> <h2 id="特殊要求"><a href="#特殊要求" aria-hidden="true" class="header-anchor">#</a> 特殊要求</h2> <p>与一般的 github page 博客不同, 本博客的源码和静态页面是分别存放在不同的仓库,而网上的教程一般都是在同一仓库</p> <h2 id="踩过的坑"><a href="#踩过的坑" aria-hidden="true" class="header-anchor">#</a> 踩过的坑</h2> <h3 id="登录-travis-ci-的-github-帐号"><a href="#登录-travis-ci-的-github-帐号" aria-hidden="true" class="header-anchor">#</a> 登录 Travis CI 的 github 帐号</h3> <p>由于本博客的源码和静态页面不但存放在不同的仓库,且仓库的帐号也是不同的.</p> <p>因此在登录 Travis CI , 应使用源码项目的 github 帐号</p> <h3 id="travis-ci-如何访问-推送静态页面至-静态页面仓库-博客站点"><a href="#travis-ci-如何访问-推送静态页面至-静态页面仓库-博客站点" aria-hidden="true" class="header-anchor">#</a> Travis CI 如何访问(推送静态页面至)静态页面仓库(博客站点)</h3> <p>由于静态页面仓库也在 github, 还是比较方便, 分两步处理即可</p> <p><code>获取 token</code></p> <ul><li>先登录 github , 用 静态页面仓库 帐号</li> <li>在帐号头像, 找到 <code>Settings-Developer settings</code></li> <li>找到 <code>Personal access tokens</code> 生成 <code>token</code> , (选项 将 <code>repo</code> 勾上)</li> <li>复制 <code>token</code> 备用</li></ul> <p><code>在 Travis CI 设置环境变量</code></p> <ul><li>首先你已经在 Travis CI 激活了仓库, 这里为博客源码仓库</li> <li>在仓库找到 <code>Settings</code> 页</li> <li>设置 <code>Environment Variables</code></li> <li>变量名可为 <code>GITHUB_TOKEN</code> ,变量名可以自已取,  值为前面复制的 <code>token</code></li></ul> <h3 id="在源码项目的根目录添加-travis-yml-文件"><a href="#在源码项目的根目录添加-travis-yml-文件" aria-hidden="true" class="header-anchor">#</a> 在源码项目的根目录添加 <code>.travis.yml</code> 文件</h3> <p>文件内容 <code>VuePress 1.x</code> 的示例是这样:</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> lts/*
<span class="token key atrule">script</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> npm run docs<span class="token punctuation">:</span>build
<span class="token key atrule">deploy</span><span class="token punctuation">:</span>
  <span class="token key atrule">provider</span><span class="token punctuation">:</span> pages
  <span class="token key atrule">skip-cleanup</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">local_dir</span><span class="token punctuation">:</span> docs/.vuepress/dist
  <span class="token key atrule">github-token</span><span class="token punctuation">:</span> $GITHUB_TOKEN <span class="token comment"># a token generated on github allowing travis to push code on you repository</span>
  <span class="token key atrule">keep-history</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">on</span><span class="token punctuation">:</span>
    <span class="token key atrule">branch</span><span class="token punctuation">:</span> master
</code></pre></div><p>这个示例只适用于源码与博客站点都在同一仓库,本文的情况应用下面的样例:</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> lts/*
<span class="token key atrule">script</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> npm run docs<span class="token punctuation">:</span>build
<span class="token key atrule">deploy</span><span class="token punctuation">:</span>
  <span class="token key atrule">provider</span><span class="token punctuation">:</span> pages
  <span class="token key atrule">repo</span><span class="token punctuation">:</span> qingfengwuyou/qingfengwuyou.github.io
  <span class="token key atrule">target_branch</span><span class="token punctuation">:</span> master
  <span class="token key atrule">skip-cleanup</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">local_dir</span><span class="token punctuation">:</span> docs/.vuepress/dist
  <span class="token key atrule">github-token</span><span class="token punctuation">:</span> $GITHUB_TOKEN
  <span class="token key atrule">keep-history</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">on</span><span class="token punctuation">:</span>
    <span class="token key atrule">branch</span><span class="token punctuation">:</span> master

</code></pre></div><p>即增加:</p> <div class="language- extra-class"><pre class="language-text"><code>  repo: qingfengwuyou/qingfengwuyou.github.io
  target_branch: master
</code></pre></div><ul><li>repo :　指明不同的仓库</li> <li>target_branch: 目标仓库的目标分支, 如果不设,默认为 <code>gh_page</code> 分支</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.835acc23.js" defer></script><script src="/assets/js/2.a5ff60db.js" defer></script><script src="/assets/js/28.446392b8.js" defer></script>
  </body>
</html>
